<!DOCTYPE html>
<html lang="uz">
<head>
  <meta charset="UTF-8" />
  <title>Ehtiyot qism qo‘shish</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <style>
    body {
      font-family: Arial, sans-serif;
      background: #f2f2f2;
      padding: 16px;
    }
    h2 {
      text-align: center;
    }
    input, button {
      width: 100%;
      padding: 14px;
      margin-top: 12px;
      font-size: 16px;
    }
    button {
      background: #007bff;
      color: white;
      border: none;
      border-radius: 8px;
    }
  </style>
</head>
<body>

<h2>Ehtiyot qism qo‘shish</h2>

<input id="name" placeholder="Ehtiyot qism nomi" />
<input id="price" type="number" placeholder="Narxi (so‘m)" />

<button onclick="addSpare()">Saqlash</button>

<script>
  function addSpare() {
    const name = document.getElementById("name").value;
    const price = Number(document.getElementById("price").value);

    if (!name || !price) {
      alert("Iltimos, barcha maydonlarni to‘ldiring");
      return;
    }

    const sales = JSON.parse(localStorage.getItem("sales") || "[]");
    sales.push({
      name,
      price,
      time: new Date().toISOString()
    });

  <script>
function saveSpare(name, price) {
  const user = auth.currentUser;

  if (!user) {
    alert("Iltimos, qayta kiring");
    return;
  }

  db.collection("users")
    .doc(user.uid)
    .collection("sales")
    .add({
      name: name,
      price: Number(price),
      createdAt: firebase.firestore.FieldValue.serverTimestamp()
    })
    .then(() => {
      alert("Saqlandi!");
      window.location.href = "dashboard.html";
    })
    .catch((error) => {
      alert("Xatolik: " + error.message);
    });
}
</script>

    window.location.href = "dashboard.html";
  }
</script>
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-firestore-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-auth-compat.js"></script>
  <script>
  <script>
  const firebaseConfig = {
    apiKey: "YOUR_API_KEY",
    authDomain: "YOUR_DOMAIN",
    projectId: "YOUR_PROJECT_ID",
    storageBucket: "YOUR_BUCKET",
    messagingSenderId: "YOUR_SENDER_ID",
    appId: "YOUR_APP_ID"
  };

<script>
  firebase.initializeApp(firebaseConfig);
  const db = firebase.firestore();
  const auth = firebase.auth();
</script>
  <script>
function saveSpare() {
  const name = document.getElementById("name").value;
  const price = document.getElementById("price").value;

  auth.onAuthStateChanged(user => {
    if (!user) {
      alert("Iltimos, qayta kiring");
      return;
    }

    db.collection("users")
      .doc(user.uid)
      .collection("sales")
      .add({
        name: name,
        price: Number(price),
        createdAt: firebase.firestore.FieldValue.serverTimestamp()
      })
      .then(() => {
        window.location.href = "dashboard.html";
      })
      .catch(err => {
        alert(err.message);
      });
  });
}
</script>
</script>
</body>
</html>
