<!DOCTYPE html>
<html lang="uz">
<head>
<meta charset="UTF-8">
<title>Barcha tovarlar</title>
<meta name="viewport" content="width=device-width, initial-scale=1">

<style>
body{
  margin:0;
  font-family:Arial;
  background:#f1f5f9;
  padding:20px;
}

.card{
  background:white;
  padding:15px;
  border-radius:12px;
  margin-bottom:10px;
  display:flex;
  justify-content:space-between;
  align-items:center;
}

button{
  padding:6px 10px;
  border:none;
  border-radius:6px;
  cursor:pointer;
}

.delete{
  background:#ef4444;
  color:white;
}
</style>
</head>
<body>

<h2>Barcha tovarlar</h2>
<div id="productList"></div>

<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-auth-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-firestore-compat.js"></script>

<script>
const firebaseConfig={
apiKey:"AIzaSyAlE6UaaXEl2FnDI6fyMWyr4IV-j1BkJ6U",
authDomain:"spare-shop-web.firebaseapp.com",
projectId:"spare-shop-web",
storageBucket:"spare-shop-web.firebasestorage.app",
messagingSenderId:"960113811021",
appId:"1:960113811021:web:8ae1451d3cba1148a0c604"
};

firebase.initializeApp(firebaseConfig);
const auth=firebase.auth();
const db=firebase.firestore();

auth.onAuthStateChanged(user=>{
if(!user){
location.href="index.html";
return;
}

db.collection("users")
.doc(user.uid)
.collection("products")
.onSnapshot(snapshot=>{

const container=document.getElementById("productList");
container.innerHTML="";

snapshot.forEach(doc=>{
const data=doc.data();

const div=document.createElement("div");
div.className="card";
div.innerHTML=`
<span>${data.name} - ${data.price.toLocaleString()} soâ€˜m</span>
<button class="delete" onclick="deleteProduct('${doc.id}')">X</button>
`;

container.appendChild(div);
});

});

});

function deleteProduct(id){
const user=auth.currentUser;
if(!user) return;

db.collection("users")
.doc(user.uid)
.collection("products")
.doc(id)
.delete();
}
</script>

</body>
</html>
